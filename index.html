<!DOCTYPE html>
<html lang="en">
  <head>
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"
    />
    <meta charset="UTF-8" />
    <title>Document</title>
    <style>
      html,
      body {
        touch-action: none; /* Prevents pinch gestures */
        user-select: none; /* Prevents double-tap zoom */
      }
      @font-face {
        font-family: "Gloock";
        src: url("./Gloock-Regular.ttf");
      }
      @font-face {
        font-family: "Inter";
        src: url("./Inter.ttf");
      }
      @font-face {
        font-family: "Lato";
        src: url("../Lato-Regular.ttf");
      }
      body {
        height: 5000px;
        color: rgb(239, 239, 239);
        background-color: black;
        user-select: none;
        font-family: "Gloock";
        letter-spacing: 0.05em;
      }
      header {
        border-top: 2px solid gray;
        border-bottom: 2px solid gray;
        display: flex;
        flex-direction: row;
        justify-content: space-around;
        position: sticky;
        top: 2.5em;
        font-family: "Lato";
      }
      #title-cont-cont {
        width: 100%;
        height: 100vh;
        display: flex;
        align-items: center;
        overflow: hidden;
        will-change: transform;
        will-change: text-shadow;
        will-change: font-size;
        will-change: line-height;
        border-bottom: 2px dashed gray;
      }
      #title-cont {
        width: 100%;
        display: flex;
        flex-direction: column;
      }
      #kenneth {
        text-align: right;
        margin-right: 10%;
      }
      #kenneth span {
        line-height: 0.5ch;
      }
      #kenneth span,
      #line-two span {
        display: inline-block;
        /*transition: text-shadow 0.05s, font-size 0.05s, line-height 0.05s;*/
        line-height: normal;
      }

      .main span p {
        padding-bottom: 10px;
        display: inline;
      }
      #line-two {
        margin-left: 10%;
        padding-top: 0;
        margin-top: 3px;
      }
      .main {
        font-family: "Gloock";
        font-size: clamp(120px, 12vw, 180px);
        text-shadow: -1px -1px 2px rgb(8, 244, 43), 4px 4px 1px gray;
      }

      #subtext {
        font-size: clamp(24px, 3vw, 64px);
        text-align: center;
        font-family: "Lato";
        text-shadow: 2px 2px 1px gray;
      }
      #break {
        background-color: rgb(8, 244, 43);
      }
    </style>
  </head>
  <body>
    <!--   <header>
      <a>About me</a>
      <a>Why I code</a>
      <a>Kennethtrancoding</a>
      <a>Settings</a>
    </header>-->
    <div id="title-cont-cont">
      <div id="title-cont">
        <span
          style="
            background-color: linear-gradient(
              rgb(0, 0, 0),
              rgba(0, 0, 0, 0),
              rgb(0, 0, 0)
            );
            position: absolute;
            width: 100vw;
            height: 100vw;
          "
        ></span>
        <div class="main" id="kenneth">Kenneth</div>
        <span id="line-two-cont">
          <div class="main" id="line-two">trancoding</div></span
        >
        <h2 id="subtext">Welcome to my corner of the web!</h2>
      </div>
    </div>
    <div class="break" style="height: 100px"><p>break</p></div>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/particlesjs/2.2.2/particles.min.js"></script>
    <script>
      document.addEventListener("gesturestart", function (e) {
        e.preventDefault();
      });

      // Disable zoom with touchmove
      document.addEventListener(
        "touchmove",
        function (e) {
          if (e.scale !== 1) {
            e.preventDefault();
          }
        },
        { passive: false }
      );
      //Variables
      let hoverAnimationEnabled = true;
      let autoSpan = "";
      // Makes each character in Kennethtrancoding an individual span

      for (let letter of $("#kenneth").text().split("")) {
        autoSpan += `<span data-original="${letter}"><p>${letter}</p></span>`;
      }
      $("#kenneth").html(autoSpan);

      $("#kenneth span").each(function () {
        $(this).attr("data-to-left", $(this).offset().left);
      });

      autoSpan = "";

      for (let letter of $("#line-two").text().split("")) {
        autoSpan += `<span data-original="${letter}"><p>${letter}</p></span>`;
      }
      $("#line-two").html(autoSpan);

      $("#line-two span").each(function () {
        $(this).attr(
          "data-to-right",
          $(window).width() - $(this).offset().left
        );
      });
      //Glitch characters, randint

      function randint(min, max) {
        return Math.floor(Math.random() * (max - min + 1)) + min;
      }
      const glitchCharacters = [
        "a",
        "b",
        "c",
        "d",
        "e",
        "f",
        "g",
        "h",
        "i",
        "j",
        "k",
        "l",
        "m",
        "n",
        "o",
        "p",
        "q",
        "r",
        "s",
        "t",
        "u",
        "v",
        "w",
        "x",
        "y",
        "z",
        "1",
        "2",
        "3",
        "4",
        "5",
        "6",
        "7",
        "8",
        "9",
        "0",
        "ð“…±",
      ];
      function glitch(item) {
        item.text(glitchCharacters[randint(0, glitchCharacters.length - 1)]);
      }
      //Mouse-over title
      let glitchInterval = null;

      $("#kenneth span, #line-two span").on("mouseover", function () {
        if (hoverAnimationEnabled) {
          let selected = $(this);
          $(this)
            .parent()
            .children()
            .each(function () {
              $(this).css({
                "text-shadow":
                  "0px 0px " +
                  20 / 1.5 ** Math.abs($(this).index() - selected.index()) +
                  "px, -1px -1px 2px rgb(8, 244, 43), 4px 4px 1px gray, 0px -6px 15px black",
                "font-size":
                  "clamp(12vw, " +
                  Math.floor(
                    13 + 15 / 3 ** Math.abs($(this).index() - selected.index())
                  ) +
                  "vw, 20vw)",
                "line-height": "0.1ex",
              });
            });

          // Clear any existing interval to prevent duplicates
          if (glitchInterval !== null) {
            clearInterval(glitchInterval);
          }

          // Start a new interval
          glitchInterval = setInterval(function () {
            glitch(selected);
          }, 100);
        }
      });

      $("#kenneth span, #line-two span").on("mouseout", function () {
        // Clear interval when mouse leaves
        if (glitchInterval !== null) {
          clearInterval(glitchInterval);
          glitchInterval = null;
          $(this).text($(this).attr("data-original"));
        }
      });
      $("#kenneth, #line-two").on("mouseout", function () {
        $(this)
          .children()
          .each(function () {
            $(this).css({
              "font-size": "",
              "text-shadow": "",
              "line-height": "normal",
              transform: "",
            });
          });
      });

      const scrollThreshold = 60;
      hoverAnimationEnabled = scrollY <= scrollThreshold;
      $(window).on("scroll", function () {
        hoverAnimationEnabled = scrollY <= scrollThreshold;
        if (scrollY > scrollThreshold) hoverAnimationEnabled = false;
        else hoverAnimationEnabled = true;

        // Translate the elements based on scroll position
        $("#kenneth").css({
          transform:
            scrollY < scrollThreshold
              ? "translate(0, 0)"
              : "translate(-" + (scrollY - scrollThreshold) + "px, 0)",
        });
        $("#line-two").css({
          transform:
            scrollY < scrollThreshold
              ? "translate(0, 0)"
              : "translate(" + (scrollY - scrollThreshold) + "px, 0)",
        });

        const opacityStart = 0; // When scrolling starts
        const opacityFadeStart = 200; // Fully opaque
        const opacityFadeEnd = 700; // Fully faded
        const opacityEnd = 700; // Maximum scroll to fully fade

        // Opacity calculation for #kenneth span
        $("#kenneth span").each(function () {
          const originalLeft = $(this).data("to-left");
          const currentLeft = $(this).offset().left;
          const distanceMoved = Math.abs(currentLeft - originalLeft);

          // Calculate opacity between 0 and 200 px fully opaque, then fading from 200px to 350px
          let opacity = 1;
          if (scrollY > opacityFadeStart && scrollY <= opacityFadeEnd) {
            opacity = Math.max(
              0,
              1 -
                (scrollY - opacityFadeStart) /
                  (opacityFadeEnd - opacityFadeStart)
            );
          }

          $(this).css({ opacity: opacity });
        });

        // Opacity calculation for #line-two span
        $("#line-two span").each(function () {
          const originalRight = $(this).data("to-right");
          const currentRight = $(window).width() - $(this).offset().left;
          const distanceMoved = Math.abs(currentRight - originalRight);

          // Calculate opacity between 0 and 200 px fully opaque, then fading from 200px to 350px
          let opacity = 1;
          if (scrollY > opacityFadeStart && scrollY <= opacityFadeEnd) {
            opacity = Math.max(
              0,
              1 -
                (scrollY - opacityFadeStart) /
                  (opacityFadeEnd - opacityFadeStart)
            );
          }

          $(this).css({ opacity: opacity });
        });

        // Opacity for subtext
        $("#subtext").css({
          opacity:
            scrollY < opacityStart
              ? 1
              : scrollY > opacityFadeEnd
              ? 0
              : 1 -
                (scrollY - opacityFadeStart) /
                  (opacityFadeEnd - opacityFadeStart),
        });
      });

      particlesJS("body", {
        particles: {
          number: { value: 80, density: { enable: true, value_area: 800 } },
          color: { value: "#00ff00" },
          shape: {
            type: "circle",
            stroke: { width: 0, color: "#000000" },
          },
          opacity: {
            value: 0.5,
            random: true,
            anim: { enable: true, speed: 1, opacity_min: 0 },
          },
          size: { value: 3, random: true, anim: { enable: false } },
          line_linked: { enable: false },
          move: { enable: true, speed: 1, direction: "none", random: true },
        },
        interactivity: {
          events: {
            onhover: { enable: true, mode: "repulse" },
          },
        },
      });
    </script>
  </body>
</html>
